/* eslint-disable @typescript-eslint/no-empty-function */
import { Injectable, inject, signal } from '@angular/core';
import { Subject, mergeMap } from 'rxjs';
import { JSONCodec, JetstreamWsService, SubscribeType } from '@his-base/jetstream-ws';
import * as i0 from "@angular/core";
export class NewsService {
    constructor() {
        this.#url = 'ws://localhost:8080';
        /** 使用Signal變數儲存UserProfile型別的使用者資訊
         * @memberof NewsService
         */
        this.userProfile = signal({});
        this.news = signal({});
        this.allNormalNews = signal({});
        this.allTodoList = signal({});
        this.normalNews = signal({});
        this.toDoList = signal({});
        this.checkedNormalNews = signal({});
        this.checkedToDoList = signal({});
        /** 使用Subject變數自nats拿取包含最新消息的使用者資訊
         * @memberof NewsService
         */
        this.#userNews = new Subject();
        this.#jetStreamWsService = inject(JetstreamWsService);
    }
    #url;
    /** 使用Subject變數自nats拿取包含最新消息的使用者資訊
     * @memberof NewsService
     */
    #userNews;
    /** 使用ConsumerMessages訂閱最新消息
     * @memberof NewsService
     */
    #consumerMessages$;
    #jetStreamWsService;
    async connect() {
        await this.#jetStreamWsService.connect(this.#url);
        console.log("nats啟動");
    }
    async disconnect() {
        // 連線關閉前，會先將目前訂閱給排空
        await this.#jetStreamWsService.drain();
    }
    /** 更新最新消息
     * @param {News[]} news
     * @memberof NewsService
     */
    getNewsFromNats() {
        this.#jetStreamWsService.publish("news.wantNews", { code: "Neo", display: "Neo" });
    }
    setNews() {
        this.news.set(mockNews);
        this.allNormalNews.set(this.getFilterNews("10"));
        this.allTodoList.set(this.getFilterNews("60"));
        this.normalNews.set(this.filterStatus(this.allNormalNews(), "10"));
        this.toDoList.set(this.filterStatus(this.allTodoList(), "10"));
        this.checkedNormalNews.set(this.filterStatus(this.allNormalNews(), "60"));
        this.checkedToDoList.set(this.filterStatus(this.allTodoList(), "60"));
    }
    /** 依‘一般消息’、’待辦工作’分類最新消息
     * @param {Coding} type
     * @return {News[]}
     * @memberof NewsService
     */
    getFilterNews(code) {
        const newsList = this.news();
        if (code) {
            return this.news().filter(m => m.type['code'] == code);
        }
        else {
            return newsList;
        }
    }
    filterStatus(news, code) {
        if (code) {
            return news.filter(m => m.execStatus['code'] == code);
        }
        else {
            return news;
        }
    }
    filterOverdue(news) {
        const date = new Date;
        const aDay = 24 * 60 * 60 * 1000;
        return news.filter(newsData => date.valueOf() - newsData.execTime.valueOf() < aDay);
    }
    showDate() {
        const nowDate = new Date();
        console.log("現在時間", nowDate);
        console.log("最新消息0", this.news());
        console.log("最新消息0time", this.news()[0].execTime);
        console.log("最新消息4timetype", typeof this.news()[4].execTime);
        console.log(nowDate.valueOf());
        console.log(this.news()[0].execTime.valueOf());
        console.log("相減", (nowDate.valueOf() - this.news()[0].execTime.valueOf()) / (1000 * 60 * 60 * 24));
    }
    /** 訂閱最新消息
     * @memberof NewsService
     */
    async subNews() {
        this.#userNews = new Subject();
        const jsonCodec = JSONCodec();
        // 'news.getNews.dashboard'
        this.#consumerMessages$ = this.#jetStreamWsService.subscribe(SubscribeType.Push, 'news.getNews.dashboard');
        console.log("ready to subscribe");
        this.#consumerMessages$
            .pipe(mergeMap(async (messages) => {
            for await (const message of messages) {
                console.log('正在聽的subject： ', message.subject);
                this.#userNews.next(jsonCodec.decode(message.data));
                message.ack();
            }
        }))
            .subscribe(() => { });
        this.#userNews.subscribe((newsList) => {
            const tmpNews = [];
            newsList.forEach((news) => {
                const tmp = {
                    "_id": news._id,
                    "appId": news.appId,
                    "userCode": news.userCode,
                    "subject": news.subject,
                    "url": news.url,
                    "sharedData": news.sharedData,
                    "period": {
                        "start": new Date(news.period.start),
                        "end": new Date(news.period.end)
                    },
                    "type": news.type,
                    "execTime": new Date(news.execTime),
                    "execStatus": news.execStatus,
                    "updatedBy": news.updatedBy,
                    "updatedAt": new Date(news.updatedAt)
                };
                tmpNews.push(tmp);
            });
            console.log("news", tmpNews);
            this.news.set(tmpNews);
            // this.normalNews.set(this.getFilterNews("10"))
            // this.toDoList.set(this.getFilterNews("60"))
            console.log("execTime", this.news()[0].execTime);
            console.log("execTime type", typeof this.news()[0].execTime);
            this.allNormalNews.set(this.getFilterNews("10"));
            this.allTodoList.set(this.getFilterNews("60"));
            this.normalNews.set(this.filterStatus(this.allNormalNews(), "10"));
            this.toDoList.set(this.filterStatus(this.allTodoList(), "10"));
            this.checkedNormalNews.set(this.filterOverdue(this.filterStatus(this.allNormalNews(), "60")));
            this.checkedToDoList.set(this.filterOverdue(this.filterStatus(this.allTodoList(), "60")));
            console.log("this.news()", this.news());
            console.log("this.normalNews()", this.normalNews());
            console.log("this.toDoListNews()", this.toDoList());
            console.log("this.checkedNormalNews()", this.checkedNormalNews());
            console.log("this.checkedToDoList()", this.checkedToDoList());
            this.showDate();
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.6", ngImport: i0, type: NewsService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.2.6", ngImport: i0, type: NewsService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.6", ngImport: i0, type: NewsService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }] });
export const mockNews = [
    {
        "_id": "64f1968af80caa4450a1d218",
        "appId": "001-app_id",
        "userCode": {
            "code": "Neo",
            "display": "Neo"
        },
        "subject": "員工健康檢查通知",
        "url": "https://www.hpc.tw",
        "sharedData": {},
        "period": {
            "start": new Date("1990-06-15T00:00"),
            "end": new Date("2229-12-31T23:59")
        },
        "type": {
            "code": "10",
            "display": "一般消息"
        },
        "execTime": new Date("2023-09-27T14:00"),
        "execStatus": {
            "code": "60",
            "display": "已讀/已完成"
        },
        "updatedBy": {
            "code": "alphaTeam",
            "display": "alphaTeam"
        },
        "updatedAt": new Date("1990-06-15T00:00")
    },
    {
        "_id": "64f1968af80caa4450a1d219",
        "appId": "002-app_id",
        "userCode": {
            "code": "Neo",
            "display": "Neo"
        },
        "subject": "您有1筆公文待簽核",
        "url": "https://www.hpc.tw",
        "sharedData": {},
        "period": {
            "start": new Date("1990-06-15T00:00"),
            "end": new Date("2229-12-31T23:59")
        },
        "type": {
            "code": "60",
            "display": "待辦工作"
        },
        "execTime": new Date("2023-09-27T14:00"),
        "execStatus": {
            "code": "60",
            "display": "已讀/已完成"
        },
        "updatedBy": {
            "code": "alphaTeam",
            "display": "alphaTeam"
        },
        "updatedAt": new Date("1990-06-15T00:00")
    },
    {
        "_id": "64f1968af80caa4450a1d21a",
        "appId": "001-app_id",
        "userCode": {
            "code": "Tommy",
            "display": "Tommy"
        },
        "subject": "員工健康檢查通知",
        "url": "https://www.hpc.tw",
        "sharedData": {},
        "period": {
            "start": new Date("1990-06-15T00:00"),
            "end": new Date("2229-12-31T23:59")
        },
        "type": {
            "code": "10",
            "display": "一般消息"
        },
        "execTime": new Date("2023-09-27T14:00"),
        "execStatus": {
            "code": "60",
            "display": "已讀/已完成"
        },
        "updatedBy": {
            "code": "alphaTeam",
            "display": "alphaTeam"
        },
        "updatedAt": new Date("1990-06-15T00:00")
    },
    {
        "_id": "64f1968af80caa4450a1d21b",
        "appId": "002-app_id",
        "userCode": {
            "code": "Tommy",
            "display": "Tommy"
        },
        "subject": "您有2筆公文待簽核",
        "url": "https://www.hpc.tw",
        "sharedData": {},
        "period": {
            "start": new Date("1990-06-15T00:00"),
            "end": new Date("2229-12-31T23:59")
        },
        "type": {
            "code": "60",
            "display": "待辦工作"
        },
        "execTime": new Date("2023-09-27T14:00"),
        "execStatus": {
            "code": "60",
            "display": "已讀/已完成"
        },
        "updatedBy": {
            "code": "alphaTeam",
            "display": "alphaTeam"
        },
        "updatedAt": new Date("1990-06-15T00:00")
    }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV3cy5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vbmV3cy1pbmZvL3NyYy9saWIvbmV3cy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHlEQUF5RDtBQUN6RCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0QsT0FBTyxFQUFjLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDckQsT0FBTyxFQUFvQixTQUFTLEVBQUUsa0JBQWtCLEVBQUUsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7O0FBT3hHLE1BQU0sT0FBTyxXQUFXO0lBSHhCO1FBS0UsU0FBSSxHQUFHLHFCQUFxQixDQUFDO1FBRTdCOztXQUVHO1FBQ0gsZ0JBQVcsR0FBRyxNQUFNLENBQWMsRUFBaUIsQ0FBQyxDQUFBO1FBRXBELFNBQUksR0FBRyxNQUFNLENBQVMsRUFBWSxDQUFDLENBQUE7UUFDbkMsa0JBQWEsR0FBRyxNQUFNLENBQVMsRUFBWSxDQUFDLENBQUE7UUFDNUMsZ0JBQVcsR0FBRyxNQUFNLENBQVMsRUFBWSxDQUFDLENBQUE7UUFDMUMsZUFBVSxHQUFHLE1BQU0sQ0FBUyxFQUFZLENBQUMsQ0FBQTtRQUN6QyxhQUFRLEdBQUcsTUFBTSxDQUFTLEVBQVksQ0FBQyxDQUFBO1FBQ3ZDLHNCQUFpQixHQUFHLE1BQU0sQ0FBUyxFQUFZLENBQUMsQ0FBQTtRQUNoRCxvQkFBZSxHQUFHLE1BQU0sQ0FBUyxFQUFZLENBQUMsQ0FBQTtRQUU5Qzs7V0FFRztRQUNILGNBQVMsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO1FBTTFCLHdCQUFtQixHQUFHLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0tBdUpsRDtJQS9LQyxJQUFJLENBQXlCO0lBZTdCOztPQUVHO0lBQ0gsU0FBUyxDQUFpQjtJQUUxQjs7T0FFRztJQUNILGtCQUFrQixDQUFn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QUssRUFBRSxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztTQUNwQztRQUNELE1BQU0sRUFBRTtZQUNOLE1BQU0sRUFBQyxJQUFJO1lBQ1gsU0FBUyxFQUFDLE1BQU07U0FDakI7UUFDRCxVQUFVLEVBQUUsSUFBSSxJQUFJLENBQUMsa0JBQWtCLENBQUM7UUFDeEMsWUFBWSxFQUFFO1lBQ1osTUFBTSxFQUFHLElBQUk7WUFDYixTQUFTLEVBQUcsUUFBUTtTQUNyQjtRQUVELFdBQVcsRUFBRTtZQUNYLE1BQU0sRUFBRyxXQUFXO1lBQ3BCLFNBQVMsRUFBRyxXQUFXO1NBQ3hCO1FBQ0QsV0FBVyxFQUFFLElBQUksSUFBSSxDQUFDLGtCQUFrQixDQUFDO0tBQzFDO0NBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvbiAqL1xuaW1wb3J0IHsgSW5qZWN0YWJsZSwgaW5qZWN0LCBzaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFVzZXJQcm9maWxlIH0gZnJvbSAnLi4vcHVibGljLWFwaSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBtZXJnZU1hcCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgQ29uc3VtZXJNZXNzYWdlcywgSlNPTkNvZGVjLCBKZXRzdHJlYW1Xc1NlcnZpY2UsIFN1YnNjcmliZVR5cGUgfSBmcm9tICdAaGlzLWJhc2UvamV0c3RyZWFtLXdzJztcbmltcG9ydCB7IE5ld3MgfSBmcm9tICdAaGlzLXZpZXdtb2RlbC9hcHBwb3J0YWwvZGlzdCc7XG5pbXBvcnQgeyBDb2RpbmcgfSBmcm9tICdAaGlzLWJhc2UvZGF0YXR5cGVzJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgTmV3c1NlcnZpY2Uge1xuXG4gICN1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6ODA4MCc7XG5cbiAgLyoqIOS9v+eUqFNpZ25hbOiuiuaVuOWEsuWtmFVzZXJQcm9maWxl5Z6L5Yil55qE5L2/55So6ICF6LOH6KiKXG4gICAqIEBtZW1iZXJvZiBOZXdzU2VydmljZVxuICAgKi9cbiAgdXNlclByb2ZpbGUgPSBzaWduYWw8VXNlclByb2ZpbGU+KHt9IGFzIFVzZXJQcm9maWxlKVxuXG4gIG5ld3MgPSBzaWduYWw8TmV3c1tdPih7fSBhcyBOZXdzW10pXG4gIGFsbE5vcm1hbE5ld3MgPSBzaWduYWw8TmV3c1tdPih7fSBhcyBOZXdzW10pXG4gIGFsbFRvZG9MaXN0ID0gc2lnbmFsPE5ld3NbXT4oe30gYXMgTmV3c1tdKVxuICBub3JtYWxOZXdzID0gc2lnbmFsPE5ld3NbXT4oe30gYXMgTmV3c1tdKVxuICB0b0RvTGlzdCA9IHNpZ25hbDxOZXdzW10+KHt9IGFzIE5ld3NbXSlcbiAgY2hlY2tlZE5vcm1hbE5ld3MgPSBzaWduYWw8TmV3c1tdPih7fSBhcyBOZXdzW10pXG4gIGNoZWNrZWRUb0RvTGlzdCA9IHNpZ25hbDxOZXdzW10+KHt9IGFzIE5ld3NbXSlcblxuICAvKiog5L2/55SoU3ViamVjdOiuiuaVuOiHqm5hdHPmi7/lj5bljIXlkKvmnIDmlrDmtojmga/nmoTkvb/nlKjogIXos4foqIpcbiAgICogQG1lbWJlcm9mIE5ld3NTZXJ2aWNlXG4gICAqL1xuICAjdXNlck5ld3MgPSBuZXcgU3ViamVjdCgpO1xuXG4gIC8qKiDkvb/nlKhDb25zdW1lck1lc3NhZ2Vz6KiC6Zax5pyA5paw5raI5oGvXG4gICAqIEBtZW1iZXJvZiBOZXdzU2VydmljZVxuICAgKi9cbiAgI2NvbnN1bWVyTWVzc2FnZXMkITogT2JzZXJ2YWJsZTxDb25zdW1lck1lc3NhZ2VzPjtcbiAgI2pldFN0cmVhbVdzU2VydmljZSA9IGluamVjdChKZXRzdHJlYW1Xc1NlcnZpY2UpO1xuXG4gIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgYXdhaXQgdGhpcy4jamV0U3RyZWFtV3NTZXJ2aWNlLmNvbm5lY3QodGhpcy4jdXJsKTtcbiAgICBjb25zb2xlLmxvZyhcIm5hdHPllZ/li5VcIilcbiAgfVxuXG4gIGFzeW5jIGRpc2Nvbm5lY3QoKSB7XG4gICAgLy8g6YCj57ea6Zec6ZaJ5YmN77yM5pyD5YWI5bCH55uu5YmN6KiC6Zax57Wm5o6S56m6XG4gICAgYXdhaXQgdGhpcy4jamV0U3RyZWFtV3NTZXJ2aWNlLmRyYWluKCk7XG4gIH1cblxuICAvKiog5pu05paw5pyA5paw5raI5oGvXG4gICAqIEBwYXJhbSB7TmV3c1tdfSBuZXdzXG4gICAqIEBtZW1iZXJvZiBOZXdzU2VydmljZVxuICAgKi9cbiAgZ2V0TmV3c0Zyb21OYXRzKCk6IHZvaWQge1xuICAgIHRoaXMuI2pldFN0cmVhbVdzU2VydmljZS5wdWJsaXNoKFwibmV3cy53YW50TmV3c1wiLCB7Y29kZTpcIk5lb1wiLGRpc3BsYXk6XCJOZW9cIn0pO1xuICB9XG5cbiAgc2V0TmV3cygpOiB2b2lke1xuICAgIHRoaXMubmV3cy5zZXQobW9ja05ld3MpXG4gICAgdGhpcy5hbGxOb3JtYWxOZXdzLnNldCh0aGlzLmdldEZpbHRlck5ld3MoXCIxMFwiKSlcbiAgICB0aGlzLmFsbFRvZG9MaXN0LnNldCh0aGlzLmdldEZpbHRlck5ld3MoXCI2MFwiKSlcblxuICAgIHRoaXMubm9ybWFsTmV3cy5zZXQodGhpcy5maWx0ZXJTdGF0dXModGhpcy5hbGxOb3JtYWxOZXdzKCksXCIxMFwiKSlcbiAgICB0aGlzLnRvRG9MaXN0LnNldCh0aGlzLmZpbHRlclN0YXR1cyh0aGlzLmFsbFRvZG9MaXN0KCksIFwiMTBcIikpXG4gICAgdGhpcy5jaGVja2VkTm9ybWFsTmV3cy5zZXQodGhpcy5maWx0ZXJTdGF0dXModGhpcy5hbGxOb3JtYWxOZXdzKCksXCI2MFwiKSlcbiAgICB0aGlzLmNoZWNrZWRUb0RvTGlzdC5zZXQodGhpcy5maWx0ZXJTdGF0dXModGhpcy5hbGxUb2RvTGlzdCgpLFwiNjBcIikpXG5cbiAgfVxuXG4gIC8qKiDkvp3igJjkuIDoiKzmtojmga/igJnjgIHigJnlvoXovqblt6XkvZzigJnliIbpoZ7mnIDmlrDmtojmga9cbiAgICogQHBhcmFtIHtDb2Rpbmd9IHR5cGVcbiAgICogQHJldHVybiB7TmV3c1tdfVxuICAgKiBAbWVtYmVyb2YgTmV3c1NlcnZpY2VcbiAgICovXG4gIGdldEZpbHRlck5ld3MoY29kZT86Q29kaW5nWydjb2RlJ10pOiBOZXdzW117XG4gICAgY29uc3QgbmV3c0xpc3Q9dGhpcy5uZXdzKClcbiAgICBpZihjb2RlKXtcbiAgICAgIHJldHVybiB0aGlzLm5ld3MoKS5maWx0ZXIobT0+bS50eXBlWydjb2RlJ109PWNvZGUpXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICByZXR1cm4gbmV3c0xpc3RcbiAgICB9XG4gIH1cblxuICBmaWx0ZXJTdGF0dXMobmV3czpOZXdzW10sIGNvZGU/OkNvZGluZ1snY29kZSddKTogTmV3c1tde1xuICAgIGlmKGNvZGUpe1xuICAgICAgcmV0dXJuIG5ld3MuZmlsdGVyKG09Pm0uZXhlY1N0YXR1c1snY29kZSddPT1jb2RlKVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgcmV0dXJuIG5ld3NcbiAgICB9XG4gIH1cblxuXG4gIGZpbHRlck92ZXJkdWUobmV3czpOZXdzW10pOiBOZXdzW117XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlXG4gICAgY29uc3QgYURheSA9IDI0KjYwKjYwKjEwMDBcbiAgICByZXR1cm4gbmV3cy5maWx0ZXIobmV3c0RhdGE9PmRhdGUudmFsdWVPZigpIC0gbmV3c0RhdGEuZXhlY1RpbWUudmFsdWVPZigpIDwgYURheSlcbiAgfVxuXG4gIHNob3dEYXRlKCl7XG4gICAgY29uc3Qgbm93RGF0ZSA9IG5ldyBEYXRlKClcbiAgICBjb25zb2xlLmxvZyhcIuePvuWcqOaZgumWk1wiLCBub3dEYXRlKVxuICAgIGNvbnNvbGUubG9nKFwi5pyA5paw5raI5oGvMFwiLHRoaXMubmV3cygpKVxuICAgIGNvbnNvbGUubG9nKFwi5pyA5paw5raI5oGvMHRpbWVcIiwgdGhpcy5uZXdzKClbMF0uZXhlY1RpbWUpXG4gICAgY29uc29sZS5sb2coXCLmnIDmlrDmtojmga80dGltZXR5cGVcIiwgdHlwZW9mIHRoaXMubmV3cygpWzRdLmV4ZWNUaW1lKVxuICAgIGNvbnNvbGUubG9nKG5vd0RhdGUudmFsdWVPZigpKVxuICAgIGNvbnNvbGUubG9nKHRoaXMubmV3cygpWzBdLmV4ZWNUaW1lLnZhbHVlT2YoKSlcbiAgICBjb25zb2xlLmxvZyhcIuebuOa4m1wiLCAobm93RGF0ZS52YWx1ZU9mKCkgLSB0aGlzLm5ld3MoKVswXS5leGVjVGltZS52YWx1ZU9mKCkpLygxMDAwKjYwKjYwKjI0KSlcbiAgfVxuXG5cbiAgLyoqIOiogumWseacgOaWsOa2iOaBr1xuICAgKiBAbWVtYmVyb2YgTmV3c1NlcnZpY2VcbiAgICovXG4gIGFzeW5jIHN1Yk5ld3MoKSB7XG4gICAgdGhpcy4jdXNlck5ld3MgPSBuZXcgU3ViamVjdCgpO1xuICAgIGNvbnN0IGpzb25Db2RlYyA9IEpTT05Db2RlYygpO1xuICAgIC8vICduZXdzLmdldE5ld3MuZGFzaGJvYXJkJ1xuICAgIHRoaXMuI2NvbnN1bWVyTWVzc2FnZXMkID0gdGhpcy4jamV0U3RyZWFtV3NTZXJ2aWNlLnN1YnNjcmliZShcbiAgICAgIFN1YnNjcmliZVR5cGUuUHVzaCxcbiAgICAgICduZXdzLmdldE5ld3MuZGFzaGJvYXJkJ1xuICAgICk7XG4gICAgY29uc29sZS5sb2coXCJyZWFkeSB0byBzdWJzY3JpYmVcIilcblxuICAgIHRoaXMuI2NvbnN1bWVyTWVzc2FnZXMkXG4gICAgICAucGlwZShcbiAgICAgICAgbWVyZ2VNYXAoYXN5bmMgKG1lc3NhZ2VzKSA9PiB7XG4gICAgICAgICAgZm9yIGF3YWl0IChjb25zdCBtZXNzYWdlIG9mIG1lc3NhZ2VzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn5q2j5Zyo6IG955qEc3ViamVjdO+8miAnLCBtZXNzYWdlLnN1YmplY3QpO1xuICAgICAgICAgICAgdGhpcy4jdXNlck5ld3MubmV4dChqc29uQ29kZWMuZGVjb2RlKG1lc3NhZ2UuZGF0YSkpO1xuICAgICAgICAgICAgbWVzc2FnZS5hY2soKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCgpID0+IHt9KTtcblxuXG4gICAgICB0aGlzLiN1c2VyTmV3cy5zdWJzY3JpYmUoKG5ld3NMaXN0OmFueSkgPT4ge1xuICAgICAgICBjb25zdCB0bXBOZXdzOk5ld3NbXSA9IFtdXG4gICAgICAgIG5ld3NMaXN0LmZvckVhY2goKG5ld3M6IE5ld3MpID0+IHtcbiAgICAgICAgICBjb25zdCB0bXA6TmV3cyA9IHtcbiAgICAgICAgICAgIFwiX2lkXCI6IG5ld3MuX2lkLFxuICAgICAgICAgICAgXCJhcHBJZFwiOiBuZXdzLmFwcElkLFxuICAgICAgICAgICAgXCJ1c2VyQ29kZVwiOiBuZXdzLnVzZXJDb2RlLFxuICAgICAgICAgICAgXCJzdWJqZWN0XCI6IG5ld3Muc3ViamVjdCxcbiAgICAgICAgICAgIFwidXJsXCI6IG5ld3MudXJsLFxuICAgICAgICAgICAgXCJzaGFyZWREYXRhXCI6IG5ld3Muc2hhcmVkRGF0YSxcbiAgICAgICAgICAgIFwicGVyaW9kXCI6IHtcbiAgICAgICAgICAgICAgXCJzdGFydFwiOiBuZXcgRGF0ZShuZXdzLnBlcmlvZC5zdGFydCksXG4gICAgICAgICAgICAgIFwiZW5kXCI6IG5ldyBEYXRlKG5ld3MucGVyaW9kLmVuZClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcInR5cGVcIjogbmV3cy50eXBlLFxuICAgICAgICAgICAgXCJleGVjVGltZVwiOiBuZXcgRGF0ZShuZXdzLmV4ZWNUaW1lKSxcbiAgICAgICAgICAgIFwiZXhlY1N0YXR1c1wiOiBuZXdzLmV4ZWNTdGF0dXMsXG4gICAgICAgICAgICBcInVwZGF0ZWRCeVwiOiBuZXdzLnVwZGF0ZWRCeSxcbiAgICAgICAgICAgIFwidXBkYXRlZEF0XCI6IG5ldyBEYXRlKG5ld3MudXBkYXRlZEF0KVxuICAgICAgICAgIH1cbiAgICAgICAgICB0bXBOZXdzLnB1c2godG1wKVxuICAgICAgICB9KTtcblxuXG4gICAgICAgIGNvbnNvbGUubG9nKFwibmV3c1wiLCB0bXBOZXdzKVxuICAgICAgICB0aGlzLm5ld3Muc2V0KHRtcE5ld3MgYXMgTmV3c1tdKTtcbiAgICAgICAgLy8gdGhpcy5ub3JtYWxOZXdzLnNldCh0aGlzLmdldEZpbHRlck5ld3MoXCIxMFwiKSlcbiAgICAgICAgLy8gdGhpcy50b0RvTGlzdC5zZXQodGhpcy5nZXRGaWx0ZXJOZXdzKFwiNjBcIikpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXhlY1RpbWVcIiwgdGhpcy5uZXdzKClbMF0uZXhlY1RpbWUpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXhlY1RpbWUgdHlwZVwiLCB0eXBlb2YgdGhpcy5uZXdzKClbMF0uZXhlY1RpbWUpXG5cblxuICAgICAgICB0aGlzLmFsbE5vcm1hbE5ld3Muc2V0KHRoaXMuZ2V0RmlsdGVyTmV3cyhcIjEwXCIpKVxuICAgICAgICB0aGlzLmFsbFRvZG9MaXN0LnNldCh0aGlzLmdldEZpbHRlck5ld3MoXCI2MFwiKSlcblxuICAgICAgICB0aGlzLm5vcm1hbE5ld3Muc2V0KHRoaXMuZmlsdGVyU3RhdHVzKHRoaXMuYWxsTm9ybWFsTmV3cygpLCBcIjEwXCIpKVxuICAgICAgICB0aGlzLnRvRG9MaXN0LnNldCh0aGlzLmZpbHRlclN0YXR1cyh0aGlzLmFsbFRvZG9MaXN0KCksXCIxMFwiKSlcbiAgICAgICAgdGhpcy5jaGVja2VkTm9ybWFsTmV3cy5zZXQodGhpcy5maWx0ZXJPdmVyZHVlKHRoaXMuZmlsdGVyU3RhdHVzKHRoaXMuYWxsTm9ybWFsTmV3cygpLCBcIjYwXCIpKSlcbiAgICAgICAgdGhpcy5jaGVja2VkVG9Eb0xpc3Quc2V0KHRoaXMuZmlsdGVyT3ZlcmR1ZSh0aGlzLmZpbHRlclN0YXR1cyh0aGlzLmFsbFRvZG9MaXN0KCksIFwiNjBcIikpKVxuICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMubmV3cygpXCIsIHRoaXMubmV3cygpKVxuICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMubm9ybWFsTmV3cygpXCIsIHRoaXMubm9ybWFsTmV3cygpKVxuICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMudG9Eb0xpc3ROZXdzKClcIiwgdGhpcy50b0RvTGlzdCgpKVxuICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMuY2hlY2tlZE5vcm1hbE5ld3MoKVwiLCB0aGlzLmNoZWNrZWROb3JtYWxOZXdzKCkpXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGhpcy5jaGVja2VkVG9Eb0xpc3QoKVwiLHRoaXMuY2hlY2tlZFRvRG9MaXN0KCkpXG4gICAgICAgIHRoaXMuc2hvd0RhdGUoKVxuXG4gICAgfSk7XG5cbiAgfVxuXG59XG5cbmV4cG9ydCBjb25zdCBtb2NrTmV3czpOZXdzW10gPVtcbiAge1xuICAgIFwiX2lkXCI6IFwiNjRmMTk2OGFmODBjYWE0NDUwYTFkMjE4XCIsXG4gICAgXCJhcHBJZFwiOiBcIjAwMS1hcHBfaWRcIixcbiAgICBcInVzZXJDb2RlXCI6IHtcbiAgICAgIFwiY29kZVwiIDogXCJOZW9cIixcbiAgICAgIFwiZGlzcGxheVwiIDogXCJOZW9cIlxuICAgIH0sXG4gICAgXCJzdWJqZWN0XCI6IFwi5ZOh5bel5YGl5bq35qqi5p+l6YCa55+lXCIsXG4gICAgXCJ1cmxcIjogXCJodHRwczovL3d3dy5ocGMudHdcIixcbiAgICBcInNoYXJlZERhdGFcIjoge30sXG4gICAgXCJwZXJpb2RcIjoge1xuICAgICAgXCJzdGFydFwiOiBuZXcgRGF0ZShcIjE5OTAtMDYtMTVUMDA6MDBcIiksXG4gICAgICBcImVuZFwiOiBuZXcgRGF0ZShcIjIyMjktMTItMzFUMjM6NTlcIilcbiAgICB9LFxuICAgIFwidHlwZVwiOiB7XG4gICAgICBcImNvZGVcIjpcIjEwXCIsXG4gICAgICBcImRpc3BsYXlcIjpcIuS4gOiIrOa2iOaBr1wiXG4gICAgfSxcbiAgICBcImV4ZWNUaW1lXCI6IG5ldyBEYXRlKFwiMjAyMy0wOS0yN1QxNDowMFwiKSxcbiAgICBcImV4ZWNTdGF0dXNcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIjYwXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwi5bey6K6AL+W3suWujOaIkFwiXG4gICAgfVxuICAgICxcbiAgICBcInVwZGF0ZWRCeVwiOiB7XG4gICAgICBcImNvZGVcIiA6IFwiYWxwaGFUZWFtXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwiYWxwaGFUZWFtXCJcbiAgICB9LFxuICAgIFwidXBkYXRlZEF0XCI6IG5ldyBEYXRlKFwiMTk5MC0wNi0xNVQwMDowMFwiKVxuICB9LFxuICB7XG4gICAgXCJfaWRcIjogXCI2NGYxOTY4YWY4MGNhYTQ0NTBhMWQyMTlcIixcbiAgICBcImFwcElkXCI6IFwiMDAyLWFwcF9pZFwiLFxuICAgIFwidXNlckNvZGVcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIk5lb1wiLFxuICAgICAgXCJkaXNwbGF5XCIgOiBcIk5lb1wiXG4gICAgfSxcbiAgICBcInN1YmplY3RcIjogXCLmgqjmnIkx562G5YWs5paH5b6F57C95qC4XCIsXG4gICAgXCJ1cmxcIjogXCJodHRwczovL3d3dy5ocGMudHdcIixcbiAgICBcInNoYXJlZERhdGFcIjoge30sXG4gICAgXCJwZXJpb2RcIjoge1xuICAgICAgXCJzdGFydFwiOiBuZXcgRGF0ZShcIjE5OTAtMDYtMTVUMDA6MDBcIiksXG4gICAgICBcImVuZFwiOiBuZXcgRGF0ZShcIjIyMjktMTItMzFUMjM6NTlcIilcbiAgICB9LFxuICAgIFwidHlwZVwiOiB7XG4gICAgICBcImNvZGVcIjpcIjYwXCIsXG4gICAgICBcImRpc3BsYXlcIjpcIuW+hei+puW3peS9nFwiXG4gICAgfSxcbiAgICBcImV4ZWNUaW1lXCI6IG5ldyBEYXRlKFwiMjAyMy0wOS0yN1QxNDowMFwiKSxcbiAgICBcImV4ZWNTdGF0dXNcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIjYwXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwi5bey6K6AL+W3suWujOaIkFwiXG4gICAgfVxuICAgICxcbiAgICBcInVwZGF0ZWRCeVwiOiB7XG4gICAgICBcImNvZGVcIiA6IFwiYWxwaGFUZWFtXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwiYWxwaGFUZWFtXCJcbiAgICB9LFxuICAgIFwidXBkYXRlZEF0XCI6IG5ldyBEYXRlKFwiMTk5MC0wNi0xNVQwMDowMFwiKVxuICB9LFxuICB7XG4gICAgXCJfaWRcIjogXCI2NGYxOTY4YWY4MGNhYTQ0NTBhMWQyMWFcIixcbiAgICBcImFwcElkXCI6IFwiMDAxLWFwcF9pZFwiLFxuICAgIFwidXNlckNvZGVcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIlRvbW15XCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwiVG9tbXlcIlxuICAgIH0sXG4gICAgXCJzdWJqZWN0XCI6IFwi5ZOh5bel5YGl5bq35qqi5p+l6YCa55+lXCIsXG4gICAgXCJ1cmxcIjogXCJodHRwczovL3d3dy5ocGMudHdcIixcbiAgICBcInNoYXJlZERhdGFcIjoge30sXG4gICAgXCJwZXJpb2RcIjoge1xuICAgICAgXCJzdGFydFwiOiBuZXcgRGF0ZShcIjE5OTAtMDYtMTVUMDA6MDBcIiksXG4gICAgICBcImVuZFwiOiBuZXcgRGF0ZShcIjIyMjktMTItMzFUMjM6NTlcIilcbiAgICB9LFxuICAgIFwidHlwZVwiOiB7XG4gICAgICBcImNvZGVcIjpcIjEwXCIsXG4gICAgICBcImRpc3BsYXlcIjpcIuS4gOiIrOa2iOaBr1wiXG4gICAgfSxcbiAgICBcImV4ZWNUaW1lXCI6IG5ldyBEYXRlKFwiMjAyMy0wOS0yN1QxNDowMFwiKSxcbiAgICBcImV4ZWNTdGF0dXNcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIjYwXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwi5bey6K6AL+W3suWujOaIkFwiXG4gICAgfVxuICAgICxcbiAgICBcInVwZGF0ZWRCeVwiOiB7XG4gICAgICBcImNvZGVcIiA6IFwiYWxwaGFUZWFtXCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwiYWxwaGFUZWFtXCJcbiAgICB9LFxuICAgIFwidXBkYXRlZEF0XCI6IG5ldyBEYXRlKFwiMTk5MC0wNi0xNVQwMDowMFwiKVxuICB9LFxuICB7XG4gICAgXCJfaWRcIjogXCI2NGYxOTY4YWY4MGNhYTQ0NTBhMWQyMWJcIixcbiAgICBcImFwcElkXCI6IFwiMDAyLWFwcF9pZFwiLFxuICAgIFwidXNlckNvZGVcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcIlRvbW15XCIsXG4gICAgICBcImRpc3BsYXlcIiA6IFwiVG9tbXlcIlxuICAgIH0sXG4gICAgXCJzdWJqZWN0XCI6IFwi5oKo5pyJMuethuWFrOaWh+W+heewveaguFwiLFxuICAgIFwidXJsXCI6IFwiaHR0cHM6Ly93d3cuaHBjLnR3XCIsXG4gICAgXCJzaGFyZWREYXRhXCI6IHt9LFxuICAgIFwicGVyaW9kXCI6IHtcbiAgICAgIFwic3RhcnRcIjogbmV3IERhdGUoXCIxOTkwLTA2LTE1VDAwOjAwXCIpLFxuICAgICAgXCJlbmRcIjogbmV3IERhdGUoXCIyMjI5LTEyLTMxVDIzOjU5XCIpXG4gICAgfSxcbiAgICBcInR5cGVcIjoge1xuICAgICAgXCJjb2RlXCI6XCI2MFwiLFxuICAgICAgXCJkaXNwbGF5XCI6XCLlvoXovqblt6XkvZxcIlxuICAgIH0sXG4gICAgXCJleGVjVGltZVwiOiBuZXcgRGF0ZShcIjIwMjMtMDktMjdUMTQ6MDBcIiksXG4gICAgXCJleGVjU3RhdHVzXCI6IHtcbiAgICAgIFwiY29kZVwiIDogXCI2MFwiLFxuICAgICAgXCJkaXNwbGF5XCIgOiBcIuW3suiugC/lt7LlrozmiJBcIlxuICAgIH1cbiAgICAsXG4gICAgXCJ1cGRhdGVkQnlcIjoge1xuICAgICAgXCJjb2RlXCIgOiBcImFscGhhVGVhbVwiLFxuICAgICAgXCJkaXNwbGF5XCIgOiBcImFscGhhVGVhbVwiXG4gICAgfSxcbiAgICBcInVwZGF0ZWRBdFwiOiBuZXcgRGF0ZShcIjE5OTAtMDYtMTVUMDA6MDBcIilcbiAgfVxuXTtcbiJdfQ==